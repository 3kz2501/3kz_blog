---
title: "Suricata における Lua スクリプト処理時のスタックオーバーフロー脆弱性(CVE-2025-64344)"
description: "ネットワーク IDS/IPS エンジンである Suricata において、Lua スクリプトで大きなバッファを処理する際にスタックオーバーフローが発生する脆弱性が発見されました。CVSS スコアは 7.5(HIGH)と評価されています。"
date: "2025/11/27"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-64344"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-64344"
tags: ["CVE", "Security", "High"]
---

# 🟠 Suricata における Lua スクリプト処理時のスタックオーバーフロー脆弱性(CVE-2025-64344)

## 概要

ネットワーク IDS/IPS エンジンである Suricata において、Lua スクリプトで大きなバッファを処理する際にスタックオーバーフローが発生する脆弱性が発見されました。CVSS スコアは 7.5(HIGH)と評価されています。

**CVE ID**: CVE-2025-64344
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-64344)

## 詳細

## 脆弱性の概要

Suricata は OISF(Open Information Security Foundation)とコミュニティによって開発されているネットワーク IDS、IPS、NSM エンジンです。バージョン 7.0.13 および 8.0.2 より前のバージョンにおいて、`LuaPushStringBuffer` 関数での無制限なスタック割り当てにより、スタックオーバーフローの脆弱性が存在します。

## 技術的詳細

- **脆弱な処理**: Lua スクリプト内で大きなバッファを扱う際、スタック領域に対して無制限にメモリが割り当てられる
- **トリガー条件**: Lua ルールまたは出力スクリプトが大きなバッファを処理する場合
- **影響を受けるコンポーネント**: Lua ルールエンジン、Lua 出力スクリプト機能

## 影響範囲

Lua ルールや出力スクリプトを使用している環境において、攻撃者が大きなバッファをルールに渡すことでスタックオーバーフローを引き起こし、サービス拒否(DoS)攻撃を実行できる可能性があります。ネットワーク監視・防御機能が停止するリスクがあります。


### 影響を受ける製品・サービス

- Suricata 7.0.13 より前のバージョン
- Suricata 8.0.2 より前のバージョン


## 対応方法

## 対応方法

### 推奨される対策
1. **パッチ適用**: Suricata を以下の修正済みバージョンにアップデートする
   - バージョン 7.0.13 以降
   - バージョン 8.0.2 以降

### 回避策(パッチ適用が困難な場合)
1. **Lua 機能の無効化**: Lua ルールおよび出力スクリプトを無効化する
2. **バッファサイズの制限**: 以下の設定を調整する
   - `stream.depth.reassembly` をスタックサイズの半分未満に設定
   - HTTP レスポンスボディの上限(`response-body-limit`)をスタックサイズの半分未満に設定

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-64344)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

---
title: "osctrl-admin に格納型XSS脆弱性 - CVE-2026-28280"
description: "osquery管理ソリューションosctrlのosctrl-adminコンポーネントにおいて、オンデマンドクエリリストに格納型XSS脆弱性が発見されました。クエリレベルの権限を持つユーザーが任意のJavaScriptを注入可能で、CSRF トークン抽出と組み合わせた権限昇格が可能です。"
date: "2026/02/27"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-28280"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-28280"
tags: ["CVE", "Security", "High"]
---

# 🟠 osctrl-admin に格納型XSS脆弱性 - CVE-2026-28280

## 概要

osquery管理ソリューションosctrlのosctrl-adminコンポーネントにおいて、オンデマンドクエリリストに格納型XSS脆弱性が発見されました。クエリレベルの権限を持つユーザーが任意のJavaScriptを注入可能で、CSRF トークン抽出と組み合わせた権限昇格が可能です。

**CVE ID**: CVE-2026-28280
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-28280)

## 詳細

## 脆弱性の概要

osctrlは、osqueryの管理ソリューションです。バージョン0.5.0未満のosctrl-adminコンポーネントにおいて、オンデマンドクエリリストに格納型クロスサイトスクリプティング（Stored XSS）脆弱性が存在します。

## 攻撃手法

1. **脆弱性の悪用方法**: クエリレベルの権限を持つユーザーが、オンデマンドクエリを実行する際にクエリパラメータを介して任意のJavaScriptコードを注入できます
2. **ペイロードの保存**: 注入されたペイロードはデータベースに保存されます
3. **自動実行**: クエリリストページを訪問したすべてのユーザー（管理者を含む）のブラウザで、保存されたスクリプトが自動的に実行されます
4. **権限昇格**: CSRFトークン抽出と組み合わせることで、ログイン中のユーザーとして操作を実行し、権限を昇格させることが可能です

## 技術的詳細

- **攻撃に必要な権限**: クエリレベル権限（最低権限レベル）
- **影響を受けるコンポーネント**: osctrl-adminのクエリリストページ
- **攻撃の連鎖**: XSS → CSRFトークン窃取 → 権限昇格 → 管理者操作の実行

## 影響範囲

最も低い権限レベルであるクエリレベルの権限を持つ攻撃者が、クエリリストを閲覧するすべてのユーザーのブラウザで任意のJavaScriptを実行できます。管理者がペイロードを実行した場合、プラットフォーム全体が完全に侵害される可能性があります。具体的には、セッションハイジャック、管理者アカウントの作成、システム設定の変更、機密データへの不正アクセスなどが可能になります。


### 影響を受ける製品・サービス

- osctrl v0.5.0未満
- osctrl-admin


## 対応方法

## 恒久的な対策

- **アップデート実施**: osctrl v0.5.0以降にアップグレードしてください（この脆弱性は修正されています）

## 暫定的な回避策

バージョンアップが困難な場合は、以下の対策を実施してください：

1. **アクセス制御の強化**: クエリレベルの権限を信頼できるユーザーのみに制限する
2. **監視の実施**: クエリリストに不審なペイロードがないか定期的に監視する
3. **アカウント監査**: osctrlのユーザーアカウントを見直し、不正な管理者アカウントがないか確認する
4. **セキュリティヘッダーの設定**: Content Security Policy (CSP)などのセキュリティヘッダーを適切に設定する

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-28280)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

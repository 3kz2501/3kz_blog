---
title: "n8n の Python Code Node にサンドボックス回避の脆弱性 - 任意コマンド実行が可能に"
description: "ワークフロー自動化プラットフォーム n8n の Pyodide ベース Python Code Node にサンドボックス回避の脆弱性が発見されました。認証済みユーザーがワークフローの作成・変更権限を悪用し、ホストシステム上で任意のコマンドを実行できる重大な問題です。"
date: "2025/12/27"
page: false
published: true
category: "security"
severity: "critical"
cve_id: "CVE-2025-68668"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-68668"
tags: ["CVE", "Security", "Critical"]
---

# 🔴 n8n の Python Code Node にサンドボックス回避の脆弱性 - 任意コマンド実行が可能に

## 概要

ワークフロー自動化プラットフォーム n8n の Pyodide ベース Python Code Node にサンドボックス回避の脆弱性が発見されました。認証済みユーザーがワークフローの作成・変更権限を悪用し、ホストシステム上で任意のコマンドを実行できる重大な問題です。

**CVE ID**: CVE-2025-68668
**深刻度**: CRITICAL
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-68668)

## 詳細

## 脆弱性の詳細

n8n はオープンソースのワークフロー自動化プラットフォームですが、バージョン 1.0.0 から 2.0.0 未満において、Pyodide を使用する Python Code Node にサンドボックス回避の脆弱性が存在します。

### 技術的背景

- **影響を受けるコンポーネント**: Python Code Node（Pyodide ベース）
- **攻撃の前提条件**: ワークフローの作成または変更権限を持つ認証済みユーザー
- **実行権限**: n8n プロセスと同等の権限で任意コマンドを実行可能
- **CVSS スコア**: 9.9（Critical）

### 攻撃シナリオ

攻撃者は正規の認証を突破した後、ワークフロー内の Python Code Node を悪用してサンドボックスを回避し、ホストシステム上で任意のコマンドを実行できます。これにより、データの窃取、システムの改ざん、さらなる攻撃の足がかりとなる可能性があります。

## 影響範囲

- **機密性**: ホストシステム上のデータへの不正アクセス
- **完全性**: システムファイルやデータの改ざん
- **可用性**: サービスの停止や妨害
- **権限昇格**: n8n プロセスの実行権限での任意コード実行
- **影響範囲**: n8n がインストールされているサーバー全体に影響が及ぶ可能性


### 影響を受ける製品・サービス

- n8n バージョン 1.0.0 から 2.0.0 未満


## 対応方法

## 対応方法

### 1. パッチ適用（推奨）
- **n8n バージョン 2.0.0 以降にアップグレード**してください

### 2. 回避策（即時対応が必要な場合）

以下のいずれかの環境変数を設定することで脆弱性を軽減できます：

**オプション A: Code Node の無効化**
```bash
NODES_EXCLUDE="[\"n8n-nodes-base.code\"]"
```

**オプション B: Python サポートの無効化**（n8n 1.104.0 以降）
```bash
N8N_PYTHON_ENABLED=false
```

**オプション C: タスクランナーベースの Python サンドボックスの使用**
```bash
N8N_RUNNERS_ENABLED=true
N8N_NATIVE_PYTHON_RUNNER=true
```

### 3. 追加のセキュリティ対策
- ワークフローの作成・変更権限を持つユーザーを最小限に制限
- アクセスログの監視とレビュー
- 不審なワークフローや Code Node の使用状況を確認

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-68668)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

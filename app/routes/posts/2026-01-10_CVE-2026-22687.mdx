---
title: "WeKnora におけるプロンプトインジェクション経由のSQLインジェクション脆弱性"
description: "LLM搭載フレームワークWeKnoraのAgentサービスにおいて、バックエンド検証の不備により、プロンプトベースのバイパス手法を悪用したSQLインジェクション攻撃が可能となる脆弱性が発見されました。"
date: "2026/01/10"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-22687"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-22687"
tags: ["CVE", "Security", "High"]
---

# 🟠 WeKnora におけるプロンプトインジェクション経由のSQLインジェクション脆弱性

## 概要

LLM搭載フレームワークWeKnoraのAgentサービスにおいて、バックエンド検証の不備により、プロンプトベースのバイパス手法を悪用したSQLインジェクション攻撃が可能となる脆弱性が発見されました。

**CVE ID**: CVE-2026-22687
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-22687)

## 詳細

## 脆弱性の詳細

WeKnoraは、深いドキュメント理解とセマンティック検索を目的としたLLM（大規模言語モデル）搭載フレームワークです。

### 脆弱性の内容

- **対象バージョン**: 0.2.5未満
- **脆弱性の種類**: SQLインジェクション（Prompt Injection経由）
- **発生条件**: Agentサービスを有効化している場合
- **攻撃手法**: プロンプトベースのバイパス技術を使用して、データベースクエリツールの制限を回避

### 技術的背景

WeKnoraのAgentサービスは、ユーザーがデータベースクエリツールを呼び出すことを許可しています。しかし、バックエンド側での入力検証が不十分であるため、攻撃者は巧妙に作成したプロンプトを使用して、本来設定されているクエリ制限を回避することが可能です。

これはLLMを活用したアプリケーション特有の脆弱性であり、従来型のSQLインジェクションとプロンプトインジェクションが組み合わさった複合的な脅威となっています。

## 影響範囲

攻撃者がこの脆弱性を悪用することで、以下の影響が発生する可能性があります：

- ターゲットサーバーおよびデータベースから機密情報の取得
- データベース内の保護されたデータへの不正アクセス
- クエリ制限の回避による権限昇格
- データベースの完全性への潜在的な脅威


### 影響を受ける製品・サービス

- WeKnora 0.2.5未満


## 対応方法

## 対応方法

### 即時対応（必須）

1. **バージョンアップデート**: WeKnoraをバージョン0.2.5以降に速やかにアップデートしてください
2. **Agentサービスの一時停止**: アップデートが困難な場合は、Agentサービスを一時的に無効化することを検討してください

### 推奨事項

- データベースアクセスログを確認し、不審なクエリ実行の痕跡がないか調査する
- 最小権限の原則に基づき、データベースユーザーの権限を見直す
- LLMを活用したアプリケーションにおけるプロンプトインジェクション対策を強化する
- 入力検証とサニタイゼーション処理の実装を強化する

### 参考情報

- 公式パッチ: バージョン0.2.5
- 公開日: 2026年1月10日

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-22687)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

---
title: "AssertJ に XXE 脆弱性、XML パース時に任意ファイル読み取りの可能性"
description: "Java テスティングライブラリ AssertJ に XML External Entity (XXE) 脆弱性が発見されました。信頼できない XML を `isXmlEqualTo` アサーションで処理する際、任意のローカルファイル読み取りや SSRF、DoS 攻撃のリスクがあります。"
date: "2026/01/27"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-24400"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-24400"
tags: ["CVE", "Security", "High"]
---

# 🟠 AssertJ に XXE 脆弱性、XML パース時に任意ファイル読み取りの可能性

## 概要

Java テスティングライブラリ AssertJ に XML External Entity (XXE) 脆弱性が発見されました。信頼できない XML を `isXmlEqualTo` アサーションで処理する際、任意のローカルファイル読み取りや SSRF、DoS 攻撃のリスクがあります。

**CVE ID**: CVE-2026-24400
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-24400)

## 詳細

## 脆弱性の詳細

AssertJ は Java および JVM 向けの流暢なテストアサーションを提供するライブラリです。バージョン 1.4.0 から 3.27.7 未満において、`org.assertj.core.util.xml.XmlStringPrettyFormatter` クラスに XXE（XML External Entity）脆弱性が存在します。

### 技術的背景

- **脆弱な箇所**: `toXmlDocument(String)` メソッドが `DocumentBuilderFactory` をデフォルト設定で初期化
- **問題点**: DTD（Document Type Definition）や外部エンティティの無効化が行われていない
- **影響を受けるメソッド**:
  - `org.assertj.core.api.AbstractCharSequenceAssert` の `isXmlEqualTo(CharSequence)`
  - `org.assertj.core.util.xml.XmlStringPrettyFormatter` の `xmlPrettyFormat(String)`

### 攻撃シナリオ

信頼できない XML 入力をこれらのメソッドで処理した場合、以下の攻撃が可能です：

1. **任意ファイル読み取り**: `file://` URI を利用して `/etc/passwd` や設定ファイルなどを読み取り
2. **SSRF（Server-Side Request Forgery）**: HTTP/HTTPS URI を利用した内部ネットワークへの不正リクエスト
3. **DoS 攻撃**: "Billion Laughs" などのエンティティ展開攻撃によるサービス拒否

### 非推奨化の経緯

`isXmlEqualTo(CharSequence)` はバージョン 3.18.0 で XMLUnit への移行が推奨され、バージョン 4.0 で削除予定となっています。

## 影響範囲

**影響を受けるアプリケーション**: AssertJ の `isXmlEqualTo(CharSequence)` または `XmlStringPrettyFormatter` を使用し、かつ信頼できない外部ソースからの XML を処理しているアプリケーションが影響を受けます。

**潜在的な被害**:
- 機密情報（設定ファイル、システムファイル等）の漏洩
- 内部ネットワークへの不正アクセス（SSRF）
- サービスの可用性低下（DoS）


### 影響を受ける製品・サービス

- AssertJ Core バージョン 1.4.0 以降 3.27.7 未満


## 対応方法

## 推奨される対応（優先度順）

### 1. XMLUnit への移行（最優先）
`isXmlEqualTo(CharSequence)` の使用を中止し、XMLUnit ライブラリへ移行してください。

### 2. パッチ適用
AssertJ Core をバージョン **3.27.7** 以降にアップグレードしてください。

### 3. 回避策（即座のアップグレードが困難な場合）
- `isXmlEqualTo(CharSequence)` や `XmlStringPrettyFormatter` を信頼できない入力で使用しない
- 入力 XML の検証・サニタイゼーションを実施

### 注意事項
- `XmlStringPrettyFormatter` はバージョン 3.27.7 で非推奨となり、バージョン 4.0 で削除される予定です（代替機能なし）
- テストコードであっても、外部入力を扱う場合はセキュリティリスクを考慮する必要があります

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-24400)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

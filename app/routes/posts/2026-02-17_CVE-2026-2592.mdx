---
title: "WooCommerce用Zarinpal Gatewayに不正アクセス制御の脆弱性"
description: "WordPress用WooCommerce向けZarinpal Gatewayプラグインに、決済状態更新における不適切なアクセス制御の脆弱性が発見されました。未認証の攻撃者が有効な認証トークンを再利用することで、適切な支払いなしに注文を支払い済みとしてマークできる可能性があります。"
date: "2026/02/17"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-2592"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-2592"
tags: ["CVE", "Security", "High"]
---

# 🟠 WooCommerce用Zarinpal Gatewayに不正アクセス制御の脆弱性

## 概要

WordPress用WooCommerce向けZarinpal Gatewayプラグインに、決済状態更新における不適切なアクセス制御の脆弱性が発見されました。未認証の攻撃者が有効な認証トークンを再利用することで、適切な支払いなしに注文を支払い済みとしてマークできる可能性があります。

**CVE ID**: CVE-2026-2592
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-2592)

## 詳細

## 脆弱性の詳細

Zarinpal Gateway for WooCommerceプラグインのバージョン5.0.16以前において、決済コールバックハンドラー `Return_from_ZarinPal_Gateway` に重大な脆弱性が存在します。

### 技術的な問題点

- コールバックURLで提供される認証トークン（authority token）が、支払い済みとしてマークされる特定の注文に実際に属しているかの検証が行われていない
- この検証の欠如により、同額の別の取引から取得した有効な認証トークンを再利用することが可能
- 攻撃者は未認証の状態でこの脆弱性を悪用できる

### 攻撃シナリオ

1. 攻撃者が正規の支払いを1件完了し、有効な認証トークンを取得
2. 同じ金額の別の注文を作成
3. 以前に取得した認証トークンをコールバックURLで再利用
4. 実際には支払いを行わずに注文を「支払い済み」としてマークすることに成功

## 影響範囲

この脆弱性により、以下の影響が想定されます：

- **金銭的損失**: ECサイト運営者が実際の支払いを受けずに商品を発送するリスク
- **不正取引の増加**: 未認証の攻撃者が認証トークンを再利用して複数の注文を不正に承認可能
- **ビジネスへの影響**: 在庫管理の混乱、売上記録の不正確さ、顧客信頼の低下
- **対象範囲**: WooCommerceでZarinpal決済ゲートウェイを使用しているすべてのWordPressサイト


### 影響を受ける製品・サービス

- Zarinpal Gateway for WooCommerce plugin 5.0.16以前のすべてのバージョン


## 対応方法

## 推奨される対応策

### 即座に実施すべき対応

1. **プラグインの更新**: バージョン5.0.17以降（修正版がリリースされ次第）への速やかなアップデート
2. **一時的な対策**: 修正版リリースまでの間、Zarinpalゲートウェイの使用を一時停止することを検討

### 追加のセキュリティ対策

- 過去の注文履歴を確認し、不審な「支払い済み」注文がないか監査
- 決済ログの詳細なレビューを実施
- 決済通知の二重チェック体制を導入
- Web Application Firewall (WAF)の導入を検討

### サイト管理者への推奨事項

- プラグイン開発者からの公式アナウンスを注視
- セキュリティパッチ適用後の動作確認を徹底
- 代替決済ゲートウェイの併用も検討

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-2592)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

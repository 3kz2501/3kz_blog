---
title: "PHP PDO PostgreSQLドライバにNULLポインタ参照の脆弱性 (CVE-2025-14180)"
description: "PHPのPDO PostgreSQLドライバにおいて、PDO::ATTR_EMULATE_PREPARES有効時に不正な文字シーケンスを含むプリペアドステートメントのパラメータがNULLポインタ参照を引き起こし、サーバクラッシュに至る脆弱性が発見されました。CVSS v3スコアは8.2 (High) です。"
date: "2025/12/28"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-14180"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-14180"
tags: ["CVE", "Security", "High"]
---

# 🟠 PHP PDO PostgreSQLドライバにNULLポインタ参照の脆弱性 (CVE-2025-14180)

## 概要

PHPのPDO PostgreSQLドライバにおいて、PDO::ATTR_EMULATE_PREPARES有効時に不正な文字シーケンスを含むプリペアドステートメントのパラメータがNULLポインタ参照を引き起こし、サーバクラッシュに至る脆弱性が発見されました。CVSS v3スコアは8.2 (High) です。

**CVE ID**: CVE-2025-14180
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-14180)

## 詳細

## 脆弱性の詳細

PHPのPDO (PHP Data Objects) PostgreSQLドライバにおいて、`PDO::ATTR_EMULATE_PREPARES`オプションを有効にしている環境で、プリペアドステートメントのパラメータに不正な文字シーケンス（例: `\x99`）が含まれる場合、PostgreSQLのクォート関数`PQescapeStringConn`がNULLを返すことがあります。

この戻り値がNULLの場合、`pdo_parse_params()`関数内でNULLポインタ参照（Null Pointer Dereference）が発生し、セグメンテーションフォルト（segmentation fault）によるクラッシュを引き起こします。

## 技術的背景

- **影響を受けるコンポーネント**: PDO PostgreSQLドライバ
- **条件**: `PDO::ATTR_EMULATE_PREPARES`が有効な状態
- **トリガー**: 不正な文字エンコーディングを含むパラメータ
- **結果**: アプリケーションクラッシュ、サービス停止

## CVSSスコア

- **スコア**: 8.2 / 10
- **深刻度**: High（重要）

## 影響範囲

この脆弱性が悪用されると、攻撃者が細工したリクエストを送信することでPHPアプリケーションをクラッシュさせることが可能です。これにより、Webサービスやアプリケーションの可用性（Availability）が損なわれ、サービス拒否（DoS）状態を引き起こす恐れがあります。特にPDO PostgreSQLを使用し、プリペアドステートメントのエミュレーションを有効にしている環境が影響を受けます。


### 影響を受ける製品・サービス

- PHP 8.1系 (8.1.34未満)
- PHP 8.2系 (8.2.30未満)
- PHP 8.3系 (8.3.29未満)
- PHP 8.4系 (8.4.16未満)
- PHP 8.5系 (8.5.1未満)


## 対応方法

## 推奨される対応

### 1. PHPバージョンのアップデート（最優先）
以下の修正済みバージョンへの更新を強く推奨します：
- PHP 8.1系: 8.1.34以上
- PHP 8.2系: 8.2.30以上
- PHP 8.3系: 8.3.29以上
- PHP 8.4系: 8.4.16以上
- PHP 8.5系: 8.5.1以上

### 2. 暫定的な回避策
アップデートが即座に実施できない場合：
- `PDO::ATTR_EMULATE_PREPARES`を無効化（`false`に設定）することを検討
- 入力値のバリデーションとサニタイゼーションを強化
- 文字エンコーディングの検証を実施

### 3. 監視とログ確認
- アプリケーションログでセグメンテーションフォルトの発生を監視
- 異常なリクエストパターンの検出

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-14180)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

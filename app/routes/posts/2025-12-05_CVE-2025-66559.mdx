---
title: "Taiko Alethia Pacayaにおけるinbox検証のポインタ破損の脆弱性"
description: "Ethereum互換のロールアップソリューションであるTaiko Alethiaにおいて、バッチ検証処理でトランジションIDポインタが破損し、検証済みチェーンの整合性が失われる脆弱性が発見されました。CVSS v3スコアは8.0（High）と評価されています。"
date: "2025/12/05"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-66559"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-66559"
tags: ["CVE", "Security", "High"]
---

# 🟠 Taiko Alethia Pacayaにおけるinbox検証のポインタ破損の脆弱性

## 概要

Ethereum互換のロールアップソリューションであるTaiko Alethiaにおいて、バッチ検証処理でトランジションIDポインタが破損し、検証済みチェーンの整合性が失われる脆弱性が発見されました。CVSS v3スコアは8.0（High）と評価されています。

**CVE ID**: CVE-2025-66559
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-66559)

## 詳細

## 脆弱性の詳細

Taiko Alethia Pacayaのバージョン2.3.1以前において、`TaikoInbox._verifyBatches`関数（packages/protocol/contracts/layer1/based/TaikoInbox.sol:627-678）に重大な実装上の欠陥が存在します。

### 技術的な問題点

- バッチ検証処理において、ローカル変数`tid`（トランジションID）が現在の`blockHash`に一致するトランジションまで進められる
- しかし、この時点ではそのバッチが実際に検証されるかどうかが確定していない
- その後、ループが中断される条件（クールダウンウィンドウ未通過、トランジション無効化など）が発生した場合でも、`batchId`をデクリメントした後に新しい`tid`が`batches[lastVerifiedBatchId].verifiedTransitionId`に書き込まれる

### 結果として生じる問題

最後に検証されたバッチが次のバッチのトランジションインデックス（多くの場合ゼロ値）を参照してしまい、検証済みチェーンのポインタが破損します。これにより、ブロックチェーンの検証チェーンの整合性が損なわれる可能性があります。

## 影響範囲

この脆弱性により、以下の影響が想定されます：

- 検証済みバッチチェーンの整合性が破壊される
- 不正確なトランジション参照による状態の不整合
- ロールアップの信頼性とセキュリティモデルの毀損
- Ethereum L1との同期における予期しない動作

CVSS v3スコア8.0（High）として評価されており、Taiko Alethiaを使用するすべてのシステムに影響を及ぼす可能性があります。


### 影響を受ける製品・サービス

- Taiko Alethia Pacaya 2.3.1以前


## 対応方法

## 推奨される対応

1. **即時対応**: Taiko Alethia Pacayaのバージョン2.3.1以前を使用している場合は、最新の修正版へのアップグレードを検討してください

2. **影響確認**: 既存のバッチ検証状態を確認し、ポインタ破損が発生していないかチェックしてください

3. **監視強化**: バッチ検証プロセスのログ監視を強化し、異常なトランジションID参照を検出できる体制を整えてください

4. **ベンダー情報の確認**: Taiko公式からのセキュリティアドバイザリやパッチ情報を継続的に確認してください

詳細情報: https://cvefeed.io/vuln/detail/CVE-2025-66559

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-66559)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

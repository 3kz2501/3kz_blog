---
title: "joserfc に任意のサイズの JWT トークンによるリソース消費の脆弱性 (CVE-2025-65015)"
description: "Python の JOSE 実装ライブラリ joserfc において、任意の大きさの JWT トークンをログに記録することでリソースを過剰消費させることができる脆弱性が発見されました。CVSS スコア 9.2 の重大な脆弱性です。"
date: "2025/11/19"
page: false
published: true
category: "security"
severity: "critical"
cve_id: "CVE-2025-65015"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-65015"
tags: ["CVE", "Security", "Critical"]
---

# 🔴 joserfc に任意のサイズの JWT トークンによるリソース消費の脆弱性 (CVE-2025-65015)

## 概要

Python の JOSE 実装ライブラリ joserfc において、任意の大きさの JWT トークンをログに記録することでリソースを過剰消費させることができる脆弱性が発見されました。CVSS スコア 9.2 の重大な脆弱性です。

**CVE ID**: CVE-2025-65015
**深刻度**: CRITICAL
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-65015)

## 詳細

## 脆弱性の詳細

joserfc は JSON Object Signing and Encryption (JOSE) 標準を実装する Python ライブラリです。本脆弱性では、`ExceededSizeError` 例外メッセージにデコードされていない JWT トークン部分が埋め込まれるため、Python のロギング機能が任意の大きさの偽造された JWT ペイロードを記録してしまう可能性があります。

## 攻撃シナリオ

攻撃者は、適切に設定されていない、または存在しない本番環境用 Web サーバーの背後にある Python Web アプリケーションに対して、HTTP リクエストヘッダーに任意の大きさの Bearer トークンを送信することができます。

## 技術的な問題点

- `joserfc.jwt.decode()` 操作中に、Python のロギングや診断ツール（Sentry など）が JWT ヘッダー全体を含む極めて大きなログメッセージを処理する可能性があります
- クレームおよび署名ペイロードサイズの検証時にも同様の挙動が発生します
- ライブラリは `joserfc.errors.ExceededSizeError()` を発生させる際、完全なペイロードを例外メッセージに埋め込みます
- この段階ではペイロードが既にメモリに完全にロードされているため、ライブラリ側で拒否できません

## 影響範囲

攻撃者が任意の大きさの JWT トークンを送信することで、以下の影響が発生する可能性があります：

- **リソース枯渇**: ログファイルやメモリの過剰消費によるサービス拒否 (DoS)
- **ディスク容量の枯渇**: 極めて大きなログメッセージの記録によるストレージの消費
- **診断ツールへの影響**: Sentry などの監視・診断ツールが大量のデータを処理することによるパフォーマンス低下
- **ログ分析の妨害**: 大量のログデータによる正常なログ分析の困難化


### 影響を受ける製品・サービス

- joserfc 1.3.3 から 1.3.5 未満
- joserfc 1.4.0 から 1.4.2 未満


## 対応方法

## 対応方法

### 即時対応（必須）

1. **パッチ適用**: joserfc を以下のバージョンにアップデートしてください
   - バージョン 1.3.5 以降（1.3.x 系列を使用している場合）
   - バージョン 1.4.2 以降（1.4.x 系列を使用している場合）

### 追加の推奨事項

2. **Web サーバー設定の見直し**: 本番環境では適切に設定された Web サーバー（Nginx、Apache など）をリバースプロキシとして配置し、リクエストヘッダーのサイズ制限を設定してください

3. **リクエストサイズの制限**: アプリケーションレベルでも HTTP ヘッダーサイズの上限を設定することを検討してください

4. **ログ監視**: 異常に大きなログエントリの発生を監視し、攻撃の兆候を早期に検出できる仕組みを導入してください

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-65015)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

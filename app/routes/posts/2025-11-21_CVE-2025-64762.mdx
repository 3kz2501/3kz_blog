---
title: "authkit-nextjs のセッションクッキーが CDN にキャッシュされる脆弱性"
description: "Next.js 向け AuthKit ライブラリにおいて、認証済みレスポンスにキャッシュ防止ヘッダーが適用されないため、CDN 環境でセッショントークンがキャッシュされ、複数のユーザーに配信される可能性がある脆弱性が発見されました。"
date: "2025/11/21"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-64762"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-64762"
tags: ["CVE", "Security", "High"]
---

# 🟠 authkit-nextjs のセッションクッキーが CDN にキャッシュされる脆弱性

## 概要

Next.js 向け AuthKit ライブラリにおいて、認証済みレスポンスにキャッシュ防止ヘッダーが適用されないため、CDN 環境でセッショントークンがキャッシュされ、複数のユーザーに配信される可能性がある脆弱性が発見されました。

**CVE ID**: CVE-2025-64762
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-64762)

## 詳細

## 脆弱性の詳細

authkit-nextjs は、WorkOS と AuthKit を使用した Next.js アプリケーションの認証とセッション管理を提供するライブラリです。

### 問題点

バージョン 2.11.0 以前の authkit-nextjs では、認証済みレスポンスに対してキャッシュ防止ヘッダー（anti-caching headers）が適切に適用されていませんでした。この問題により、CDN キャッシングが有効な環境では以下のリスクが生じます：

- セッショントークンを含むレスポンスが CDN にキャッシュされる
- キャッシュされたレスポンスが複数の異なるユーザーに配信される
- 結果として、不正なセッション共有が発生する可能性がある

### 影響を受けない環境

Vercel にデプロイされた Next.js アプリケーションは、認証パスに対して手動でキャッシュヘッダーを設定していない限り影響を受けません。

### 修正内容

バージョン 2.11.1 では、認証が必要なすべてのレスポンスに対してキャッシュ防止ヘッダーが適用されるようになりました。

## 影響範囲

CDN キャッシングが有効な環境において、あるユーザーのセッショントークンが他のユーザーに漏洩する可能性があります。これにより、アカウントの不正アクセスや情報漏洩のリスクが生じます。CVSS スコアは 8.0（HIGH）と評価されています。


### 影響を受ける製品・サービス

- authkit-nextjs 2.11.0 以前のバージョン


## 対応方法

## 推奨される対応

1. **即座のアップグレード**: authkit-nextjs をバージョン 2.11.1 以降にアップデートしてください
2. **キャッシュ設定の確認**: CDN キャッシングを有効にしている場合は、認証パスが適切に除外されているか確認してください
3. **セッションの無効化**: 脆弱性の影響を受けた可能性がある場合は、既存のセッションを無効化することを検討してください
4. **ログの確認**: 不審なセッション共有やアクセスパターンがないか監査ログを確認してください

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-64762)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

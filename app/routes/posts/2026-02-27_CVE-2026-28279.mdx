---
title: "osctrl-admin におけるOSコマンドインジェクションの脆弱性"
description: "osquery管理ソリューションosctrlのadmin機能において、環境設定のホスト名パラメータを介した任意のOSコマンド実行が可能な脆弱性が発見されました。攻撃者は管理者権限を悪用し、登録スクリプトを通じてすべてのエンドポイントでroot/SYSTEM権限でコードを実行できます。"
date: "2026/02/27"
page: false
published: true
category: "security"
severity: "critical"
cve_id: "CVE-2026-28279"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-28279"
tags: ["CVE", "Security", "Critical"]
---

# 🔴 osctrl-admin におけるOSコマンドインジェクションの脆弱性

## 概要

osquery管理ソリューションosctrlのadmin機能において、環境設定のホスト名パラメータを介した任意のOSコマンド実行が可能な脆弱性が発見されました。攻撃者は管理者権限を悪用し、登録スクリプトを通じてすべてのエンドポイントでroot/SYSTEM権限でコードを実行できます。

**CVE ID**: CVE-2026-28279
**深刻度**: CRITICAL
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-28279)

## 詳細

## 脆弱性の詳細

osctrlはosqueryの管理ソリューションですが、バージョン0.5.0未満の`osctrl-admin`において、環境設定機能にOSコマンドインジェクションの脆弱性が存在します。

## 攻撃手法

認証された管理者が環境の作成または編集時に、hostnameパラメータを介して任意のシェルコマンドを注入できます。これらのコマンドは、Goの`text/template`パッケージを使用して生成される登録ワンライナースクリプトに埋め込まれます。このパッケージはシェルエスケープ処理を行わないため、注入されたコマンドがそのまま実行されます。

## 攻撃の影響範囲

- 侵害された環境を使用して登録するすべてのエンドポイントで、注入されたコマンドが実行される
- コマンドはroot/SYSTEM権限（osquery登録に使用される特権レベル）で実行される
- osqueryインストール前に実行されるため、エージェントレベルの監査ログが残らない
- バックドアのインストール、認証情報の窃取、エンドポイントの完全な侵害が可能

## 影響範囲

管理者権限を持つ攻撃者は、侵害された環境を使用して登録するすべてのエンドポイントでリモートコードを実行できます。コマンドはroot/SYSTEM権限で実行され、osqueryインストール前に実行されるためエージェントレベルの監査証跡が残りません。これにより、バックドアのインストール、認証情報の窃取、エンドポイントの完全な侵害が可能となります。


### 影響を受ける製品・サービス

- osctrl v0.5.0未満
- osctrl-admin


## 対応方法

## 対応方法

### 根本的な対策

- **osctrl v0.5.0以降へのアップグレード**: この脆弱性は v0.5.0 で修正されています

### 回避策（アップグレードできない場合）

1. **アクセス制限**: osctrl管理者アクセスを信頼できる担当者のみに制限する
2. **設定レビュー**: 既存の環境設定を見直し、疑わしいホスト名がないか確認する
3. **スクリプト監視**: 登録スクリプトに予期しないコマンドが含まれていないか監視する

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-28279)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

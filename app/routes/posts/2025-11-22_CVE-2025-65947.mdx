---
title: "thread-amount ライブラリにおけるリソース枯渇の脆弱性（Windows/macOS）"
description: "プロセス内のスレッド数を取得するツール「thread-amount」のバージョン0.2.2未満において、WindowsおよびmacOSプラットフォームでリソースリーク（メモリリークおよびハンドルリーク）が発生する脆弱性が発見されました。CVSS スコア 8.7（HIGH）に分類されています。"
date: "2025/11/22"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-65947"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-65947"
tags: ["CVE", "Security", "High"]
---

# 🟠 thread-amount ライブラリにおけるリソース枯渇の脆弱性（Windows/macOS）

## 概要

プロセス内のスレッド数を取得するツール「thread-amount」のバージョン0.2.2未満において、WindowsおよびmacOSプラットフォームでリソースリーク（メモリリークおよびハンドルリーク）が発生する脆弱性が発見されました。CVSS スコア 8.7（HIGH）に分類されています。

**CVE ID**: CVE-2025-65947
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-65947)

## 詳細

## 脆弱性の詳細

### Windows プラットフォームでの問題
`thread_amount` 関数が `CreateToolhelp32Snapshot` を呼び出した後、返された `HANDLE` を `CloseHandle` で適切にクローズしていません。この関数を繰り返し呼び出すと、プロセスのハンドル数が無制限に増加し、最終的にハンドル上限に達してシステムの不安定化またはプロセスの強制終了を引き起こします。

### macOS プラットフォームでの問題
`thread_amount` 関数が Mach カーネル API 経由で `task_threads` を呼び出し、スレッドリスト用のメモリを割り当てますが、`vm_deallocate` を使用してこのメモリを解放していません。繰り返し呼び出すことで継続的なメモリリークが発生し、最終的にプロセスが OOM (Out of Memory) キラーによって強制終了されます。

## 公開日時
2025年11月21日（UTC）

## 影響範囲

この脆弱性により、thread-amount ライブラリを使用するアプリケーションにおいて、以下の影響が発生する可能性があります：

- **Windows環境**: ハンドルリークによるシステムリソースの枯渇、プロセスのクラッシュ、システム全体の不安定化
- **macOS環境**: メモリリークによるメモリ枯渇、OOMキラーによるプロセス強制終了
- **共通**: サービス拒否（DoS）状態の発生、アプリケーションの可用性低下


### 影響を受ける製品・サービス

- thread-amount 0.2.2未満


## 対応方法

## 対応方法

**即時対応**: thread-amount ライブラリをバージョン **0.2.2** 以降にアップデートしてください。このバージョンでリソースリークの問題が修正されています。

## 推奨事項

1. 使用中の thread-amount ライブラリのバージョンを確認
2. バージョン 0.2.2 未満の場合は速やかにアップデート
3. 依存関係管理ツール（npm、cargo など）を使用して最新版を適用
4. アップデート後、リソース使用状況を監視し、リークが解消されていることを確認

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-65947)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

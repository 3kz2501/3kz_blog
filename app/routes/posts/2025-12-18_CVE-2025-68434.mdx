---
title: "Open Source Point of Sale に管理者アカウント不正作成を許すCSRF脆弱性"
description: "Open Source Point of Saleにクロスサイトリクエストフォージェリ(CSRF)脆弱性が発見されました。CSRF保護が意図的に無効化されており、攻撃者が管理者権限を持つアカウントを不正に作成できる重大な問題です。"
date: "2025/12/18"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-68434"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-68434"
tags: ["CVE", "Security", "High"]
---

# 🟠 Open Source Point of Sale に管理者アカウント不正作成を許すCSRF脆弱性

## 概要

Open Source Point of Saleにクロスサイトリクエストフォージェリ(CSRF)脆弱性が発見されました。CSRF保護が意図的に無効化されており、攻撃者が管理者権限を持つアカウントを不正に作成できる重大な問題です。

**CVE ID**: CVE-2025-68434
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-68434)

## 詳細

## 脆弱性の概要

Open Source Point of Sale (opensourcepos) はPHPとCodeIgniterフレームワークで書かれたWebベースのPOSアプリケーションです。バージョン3.4.0から3.4.2未満において、CSRF保護メカニズムが**明示的に無効化**されていることが判明しました。

## 技術的詳細

- **脆弱性タイプ**: クロスサイトリクエストフォージェリ(CSRF)
- **影響範囲**: 状態変更リクエスト(POST)がCSRFトークンの検証なしで処理される
- **攻撃シナリオ**: 
  1. 攻撃者が悪意のあるWebページをホスティング
  2. ログイン中の管理者がそのページにアクセス
  3. ブラウザが自動的に不正なリクエストを送信
  4. 攻撃者が管理者権限を持つ新規アカウントを作成

## 深刻度

- **CVSSスコア**: 8.8 (HIGH)
- **認証**: 不要(未認証の攻撃者が実行可能)
- **影響**: システムの完全な乗っ取り、機密性・完全性・可用性の喪失

## 影響範囲

攻撃が成功すると、攻撃者は完全な管理者権限を持つアカウントを密かに作成でき、システム全体の乗っ取りにつながります。これにより、機密情報の窃取、データの改ざん、サービスの停止など、あらゆる不正操作が可能になります。ログイン中の管理者が悪意のあるWebページにアクセスするだけで被害を受ける可能性があります。


### 影響を受ける製品・サービス

- Open Source Point of Sale (opensourcepos) 3.4.0以上3.4.2未満


## 対応方法

## 推奨される対応

### 1. パッチ適用（推奨）
- **バージョン3.4.2にアップデート**することを強く推奨します
- このバージョンでは`app/Config/Filters.php`でCSRFフィルタが再有効化され、AJAXの競合状態問題も解決されています

### 2. 一時的な回避策（非推奨）
- `app/Config/Filters.php`でCSRFフィルタを手動で再有効化
- **注意**: 完全なパッチを適用せずにこの対応を行うと、トークン同期の問題により販売モジュールが正常に動作しなくなる可能性があります

### 3. 追加の対策
- 管理者に対して、不審なリンクやWebページへのアクセスを避けるよう注意喚起
- アクセスログを監視し、不審な管理者アカウントの作成がないか確認

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-68434)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

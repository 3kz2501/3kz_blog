---
title: "Apollo Federationのインターフェース型におけるアクセス制御バイパスの脆弱性"
description: "Apollo Federationのcompositionロジックにおいて、インターフェース型・フィールドに設定されたアクセス制御ディレクティブが、インラインフラグメントを使用した実装オブジェクト型への直接クエリによってバイパスできる脆弱性が発見されました。CVSSスコアは7.5（HIGH）です。"
date: "2025/11/14"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-64530"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-64530"
tags: ["CVE", "Security", "High"]
---

# 🟠 Apollo Federationのインターフェース型におけるアクセス制御バイパスの脆弱性

## 概要

Apollo Federationのcompositionロジックにおいて、インターフェース型・フィールドに設定されたアクセス制御ディレクティブが、インラインフラグメントを使用した実装オブジェクト型への直接クエリによってバイパスできる脆弱性が発見されました。CVSSスコアは7.5（HIGH）です。

**CVE ID**: CVE-2025-64530
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-64530)

## 詳細

## 脆弱性の詳細

Apollo Federationは、複数のAPIを統合グラフとして宣言的に構成するアーキテクチャです。この脆弱性は、compositionロジックにおけるアクセス制御の不適切な実装に起因します。

### 問題の内容

- Apollo Federationがインターフェース型・フィールドにユーザー定義のアクセス制御ディレクティブを誤って許可していた
- 攻撃者はインラインフラグメントを使用して実装オブジェクト型・フィールドに直接クエリすることで、インターフェース型に設定されたアクセス制御を回避可能
- `@authenticated`、`@requiresScopes`、`@policy`などのアクセス制御ディレクティブが影響を受ける

### 技術的背景

GraphQLのインターフェース型に設定されたアクセス制御が、その実装型に自動的に継承されない設計上の問題により、セキュリティポリシーの一貫性が損なわれていました。

## 影響範囲

この脆弱性により、以下の影響が想定されます：

- **権限のないデータアクセス**: 本来アクセス権限のないユーザーが、インターフェース型で保護されているはずのデータにアクセス可能
- **アクセス制御のバイパス**: 認証・認可メカニズムの回避による機密情報の漏洩リスク
- **影響を受けるユーザー**: Apollo Routerのアクセス制御機能を使用し、かつインターフェース型・フィールドにアクセス制御要件を指定しているユーザー

**影響を受けないケース**: アクセス制御機能を使用していない場合、またはインターフェース型にアクセス制御を設定していない場合は影響を受けません。


### 影響を受ける製品・サービス

- Apollo Federation 2.9.5未満
- Apollo Federation 2.10.4未満
- Apollo Federation 2.11.5未満
- Apollo Federation 2.12.1未満
- Apollo Router（アクセス制御機能使用時）
- Apollo Rover（未パッチのcompositionバージョン）
- Apollo Studio（Federation 2.8以下）


## 対応方法

## 対応方法

### パッチ適用（推奨）

以下のバージョンへのアップグレードを実施してください：
- Apollo Federation **2.9.5**以上
- Apollo Federation **2.10.4**以上
- Apollo Federation **2.11.5**以上
- Apollo Federation **2.12.1**以上

これらのバージョンでは、インターフェース型・フィールドにユーザー定義のアクセス制御ディレクティブを含めることが禁止されています。

### ワークアラウンド（暫定対応）

パッチ適用が困難な場合：

1. **手動でのアクセス制御のコピー**: インターフェース型・フィールドのアクセス制御要件を、実装する各オブジェクト型・フィールドに手動でコピー
2. **重要**: インターフェース型からアクセス制御要件を削除しないこと（未パッチのcompositionでは自動生成されないため）
3. Apollo Rover使用時やApollo Studio（Federation 2.8以下）使用時は特に注意が必要

### 影響確認

- 自環境でアクセス制御ディレクティブの使用状況を確認
- インターフェース型に設定されたアクセス制御ポリシーの棚卸しを実施

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-64530)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

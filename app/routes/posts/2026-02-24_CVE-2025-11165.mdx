---
title: "dotCMS Velocity エンジンにサンドボックス回避の重大な脆弱性（CVE-2025-11165）"
description: "dotCMSのVelocityスクリプティングエンジン（VTools）に、認証済みユーザーがサンドボックス制限を回避して任意のシステムコマンドを実行できる重大な脆弱性が発見されました。CVSS深刻度は9.4（Critical）です。"
date: "2026/02/24"
page: false
published: true
category: "security"
severity: "critical"
cve_id: "CVE-2025-11165"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-11165"
tags: ["CVE", "Security", "Critical"]
---

# 🔴 dotCMS Velocity エンジンにサンドボックス回避の重大な脆弱性（CVE-2025-11165）

## 概要

dotCMSのVelocityスクリプティングエンジン（VTools）に、認証済みユーザーがサンドボックス制限を回避して任意のシステムコマンドを実行できる重大な脆弱性が発見されました。CVSS深刻度は9.4（Critical）です。

**CVE ID**: CVE-2025-11165
**深刻度**: CRITICAL
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-11165)

## 詳細

## 脆弱性の詳細

dotCMSのVelocityスクリプティングエンジン（VTools）において、サンドボックスエスケープの脆弱性が確認されました。この脆弱性により、スクリプト実行権限を持つ認証済みユーザーが、`SecureUberspectorImpl`によって強制されているクラスおよびパッケージの制限を回避できます。

## 攻撃手法

攻撃者は以下の手順で脆弱性を悪用できます：

1. Velocityエンジンのランタイム設定を動的に変更
2. Uberspectを再初期化することで、`introspector.restrict.classes`および`introspector.restrict.packages`の保護機能を削除
3. これらの制限が解除されると、`java.lang.Runtime`を含む任意のJavaクラスへのアクセスが可能になる
4. アプリケーションプロセス（dotCMSまたはTomcatユーザー）の権限で任意のシステムコマンドを実行

## 技術的背景

Velocityエンジンはセキュリティ機構として、特定のクラスやパッケージへのアクセスを制限するイントロスペクター機能を提供しています。しかし、本脆弱性ではこの制限自体を動的に無効化できるため、サンドボックスが完全に無効化されます。

## 影響範囲

この脆弱性により、スクリプト実行権限を持つ認証済みの悪意あるユーザーは以下の影響を引き起こす可能性があります：

- アプリケーションサーバー上での任意のシステムコマンド実行
- dotCMSまたはTomcatユーザーの権限での不正操作
- サーバーの完全な侵害
- 機密データへの不正アクセス
- サービス妨害（DoS）攻撃
- ラテラルムーブメントの起点として悪用される可能性

CVSS深刻度が9.4（Critical）と評価されており、早急な対応が必要です。


### 影響を受ける製品・サービス

- dotCMS（Velocityスクリプティングエンジン搭載バージョン）


## 対応方法

## 推奨される対応策

1. **パッチ適用**: dotCMS提供元から公開されるセキュリティパッチを速やかに適用してください
2. **権限の見直し**: Velocityスクリプト実行権限を持つユーザーを最小限に制限し、定期的に監査を実施してください
3. **監視強化**: Velocityエンジンの設定変更やUberspectの再初期化を検出できる監視体制を構築してください
4. **ワークアラウンド**: パッチ適用までの間、Velocityスクリプティング機能へのアクセスを制限することを検討してください
5. **ログ確認**: 過去のログを確認し、不審なスクリプト実行や設定変更がないか調査してください

詳細情報や最新のパッチ情報については、dotCMSの公式セキュリティアドバイザリを参照してください。

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-11165)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

---
title: "HUSTOJ にCSVインジェクション脆弱性、コンテストランキングエクスポート機能に深刻な影響"
description: "オンラインジャッジシステムHUSTOJにCSVインジェクション（数式インジェクション）の脆弱性が発見されました。コンテストランキングのエクスポート機能を通じて、管理者のマシン上で任意のコマンドが実行される可能性があります。"
date: "2026/01/22"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-23873"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-23873"
tags: ["CVE", "Security", "High"]
---

# 🟠 HUSTOJ にCSVインジェクション脆弱性、コンテストランキングエクスポート機能に深刻な影響

## 概要

オンラインジャッジシステムHUSTOJにCSVインジェクション（数式インジェクション）の脆弱性が発見されました。コンテストランキングのエクスポート機能を通じて、管理者のマシン上で任意のコマンドが実行される可能性があります。

**CVE ID**: CVE-2026-23873
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-23873)

## 詳細

## 脆弱性の概要

HUSTOJは、ACM/ICPCやNOIP訓練のためのPHP/C++/MySQL/Linuxベースのオープンソースオンラインジャッジシステムです。このシステムの全バージョンに、CSV Injection（Formula Injection）の脆弱性が存在することが判明しました。

## 脆弱性の詳細

**影響を受ける機能:**
- `contestrank.xls.php`
- `admin/ranklist_export.php`

**攻撃手法:**

1. 攻撃者が「ニックネーム」フィールドにExcelの数式を入力
2. 管理者がコンテストランキングを`.xls`ファイルとしてエクスポート
3. エクスポートされたファイルをMicrosoft Excelで開くと、数式が自動実行される

**技術的な問題点:**

アプリケーションは、ユーザー入力（特にニックネームフィールド）を適切にサニタイズせずに`.xls`ファイルにエクスポートしています。このファイルはHTMLテーブルとしてレンダリングされますが、Excelで開かれた際に数式として解釈されます。

## 悪用シナリオ

- **任意コード実行（RCE）**: 管理者のマシン上で悪意のあるコマンドを実行
- **データ窃取**: 機密情報の外部送信
- **システム侵害**: 管理者権限を利用したさらなる攻撃

## 影響範囲

攻撃者が悪意のあるニックネームを登録し、管理者がランキングリストをエクスポート・開封することで、管理者のマシン上で任意のコマンドが実行される可能性があります。これにより、機密データの窃取、マルウェアの配布、システム全体の侵害につながる恐れがあります。特に教育機関や競技プログラミング運営者が標的となる可能性が高いです。


### 影響を受ける製品・サービス

- HUSTOJ（全バージョン）


## 対応方法

**現時点での対応:**

公開時点（2026年1月21日）で修正パッチは提供されていません。

**推奨される緊急対応策:**

1. **エクスポート機能の一時停止**: コンテストランキングのエクスポート機能の使用を控える
2. **マニュアル確認**: エクスポートファイルを開く前に、テキストエディタで内容を確認し、`=`、`+`、`-`、`@`で始まる疑わしいセルがないかチェック
3. **Excelの保護ビュー**: Microsoft Excelの保護ビュー機能を有効化し、外部ファイルを開く際の警告に注意
4. **ユーザー入力の監視**: ニックネームフィールドに数式記号を含む登録がないか監視
5. **アップデート監視**: HUSTOJ公式リポジトリでセキュリティパッチの公開を継続的に確認

**開発者向け:**

- ユーザー入力をエクスポートする際は、先頭の特殊文字（`=`, `+`, `-`, `@`, タブ、改行）をエスケープまたは削除
- CSV/Excelエクスポート時は適切なサニタイゼーション処理を実装

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-23873)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

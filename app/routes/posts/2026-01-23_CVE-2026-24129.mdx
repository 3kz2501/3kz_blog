---
title: "Runtipi に認証済みユーザーによる任意のリモートコード実行の脆弱性"
description: "Docker ベースのホームサーバーオーケストレーター Runtipi において、認証済みユーザーがバックアップファイル名にシェルメタ文字を注入することで、ホストサーバー上で任意のシステムコマンドを実行できる脆弱性が発見されました。CVSS スコアは 8.0（HIGH）です。"
date: "2026/01/23"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-24129"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-24129"
tags: ["CVE", "Security", "High"]
---

# 🟠 Runtipi に認証済みユーザーによる任意のリモートコード実行の脆弱性

## 概要

Docker ベースのホームサーバーオーケストレーター Runtipi において、認証済みユーザーがバックアップファイル名にシェルメタ文字を注入することで、ホストサーバー上で任意のシステムコマンドを実行できる脆弱性が発見されました。CVSS スコアは 8.0（HIGH）です。

**CVE ID**: CVE-2026-24129
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-24129)

## 詳細

## 脆弱性の詳細

Runtipi は Docker ベースのパーソナルホームサーバーオーケストレーターで、単一サーバー上で複数のサービスを管理できるツールです。バージョン 3.7.0 以降に深刻な脆弱性が存在します。

## 攻撃手法

本脆弱性は、BackupManager がアップロードされたバックアップファイル名を適切にサニタイズしていないことに起因します。

1. **ファイル名の不適切な処理**: システムはユーザーがアップロードしたファイルを、リクエストで提供された元のファイル名（`originalname`）をそのまま使用してホストファイルシステムに保存します
2. **シェルメタ文字の注入**: 攻撃者はシェルメタ文字を含むファイル名（例: `$(id).tar.gz`）を使用してファイルをアップロードできます
3. **予測可能なパス**: ファイルは予測可能なパスに保存されます
4. **リストア処理での実行**: リストア（復元）プロセス中に、保存されたファイルが参照され、埋め込まれたコマンドが実行されます

## 技術的な問題点

- バックアップファイル名の入力検証が不十分
- シェルメタ文字（`$`, `` ` ``, `(`, `)` など）のエスケープ処理がない
- ファイル名がシェルコマンドのコンテキストで使用される際の適切なサニタイゼーションの欠如

## 影響範囲

認証済みユーザーが、ホストサーバー上で任意のシステムコマンドを実行可能です。これにより、以下のリスクが生じます：

- サーバーの完全な制御権限の取得
- 機密データへの不正アクセス
- システムの改ざんや破壊
- 他のサービスやコンテナへの侵害
- 権限昇格による更なる攻撃の実行

CVSS スコア 8.0（HIGH）が示す通り、深刻度の高い脆弱性です。ただし、攻撃には認証が必要なため、未認証の攻撃者による直接的な悪用は困難です。


### 影響を受ける製品・サービス

- Runtipi バージョン 3.7.0 以上 4.7.0 未満


## 対応方法

## 対応方法

**即座に実施すべき対策:**

1. **バージョン 4.7.0 へのアップグレード**: 本脆弱性は バージョン 4.7.0 で修正されています。速やかにアップデートを適用してください
2. **認証管理の強化**: 信頼できるユーザーのみにアクセス権限を付与し、定期的にアクセス権限を見直してください
3. **バックアップ操作の監視**: バックアップのアップロードおよびリストア操作のログを監視し、不審なファイル名パターンを検出してください

## 暫定的な対策（アップグレードが即座にできない場合）

- バックアップ機能へのアクセスを最小限の管理者のみに制限
- ファイルアップロード操作の詳細なログ記録と監視
- 不審なファイル名（特殊文字を含むもの）の手動チェック

## 参考情報

- CVE-2026-24129
- CVSS スコア: 8.0（HIGH）
- 影響バージョン: 3.7.0 以上 4.7.0 未満
- 修正バージョン: 4.7.0

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-24129)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

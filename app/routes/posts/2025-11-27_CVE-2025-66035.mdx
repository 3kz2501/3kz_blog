---
title: "Angular HTTP ClientにおけるXSRFトークン漏洩の脆弱性"
description: "AngularのHTTP Clientにおいて、プロトコル相対URL（//で始まるURL）を使用した際に、XSRF（クロスサイトリクエストフォージェリ）トークンが攻撃者の管理するドメインに漏洩する脆弱性が発見されました。CVSS スコアは7.7（HIGH）と評価されています。"
date: "2025/11/27"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-66035"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-66035"
tags: ["CVE", "Security", "High"]
---

# 🟠 Angular HTTP ClientにおけるXSRFトークン漏洩の脆弱性

## 概要

AngularのHTTP Clientにおいて、プロトコル相対URL（//で始まるURL）を使用した際に、XSRF（クロスサイトリクエストフォージェリ）トークンが攻撃者の管理するドメインに漏洩する脆弱性が発見されました。CVSS スコアは7.7（HIGH）と評価されています。

**CVE ID**: CVE-2025-66035
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-66035)

## 詳細

## 脆弱性の詳細

AngularはTypeScript/JavaScriptを使用したモバイルおよびデスクトップWebアプリケーション開発プラットフォームです。今回の脆弱性は、AngularのHttpClientに組み込まれているXSRF保護メカニズムの実装上の欠陥に起因しています。

### 問題の原因

AngularのHttpClientは、リクエストURLが`http://`または`https://`で始まるかどうかをチェックすることで、クロスオリジンリクエストかどうかを判断します。しかし、プロトコル相対URL（`//`で始まるURL）が使用された場合、誤って同一オリジンリクエストとして扱われてしまいます。

この結果、XSRFトークンが自動的に`X-XSRF-TOKEN`ヘッダーに追加され、攻撃者が管理するドメインに送信されてしまう可能性があります。

### 脆弱性の種類

- **Credential Leak by App Logic（アプリケーションロジックによる認証情報漏洩）**
- XSRF/CSRFトークンの不正な開示

### 影響を受けるバージョン

- Angular 19.2.15以前
- Angular 20.3.13以前
- Angular 21.0.0以前

## 影響範囲

この脆弱性により、攻撃者は被害者のXSRFトークンを取得することが可能になります。取得されたトークンを悪用することで、被害者になりすましてCSRF攻撃を実行し、不正なリクエストを送信される可能性があります。これにより、ユーザーの意図しない操作（データの変更、削除、不正な取引など）が実行されるリスクがあります。


### 影響を受ける製品・サービス

- Angular 19.2.15以前
- Angular 20.3.13以前
- Angular 21.0.0以前


## 対応方法

## 対応方法

### パッチ適用（推奨）

以下のバージョンにアップデートすることで脆弱性が修正されます：

- **Angular 19.2.16以降**
- **Angular 20.3.14以降**
- **Angular 21.0.1以降**

### 回避策（一時的な対応）

アップデートが即座に実施できない場合は、以下の回避策を実施してください：

1. **プロトコル相対URLの使用を避ける**
   - `//`で始まるURLをHttpClientリクエストで使用しない

2. **相対パスの使用**
   - バックエンド通信URLは単一の`/`で始まる相対パスとしてハードコードする

3. **完全修飾URLの使用**
   - 信頼できる絶対URLを明示的に指定する（`https://trusted-domain.com/api`など）

### 推奨事項

- 速やかにパッチ適用を実施すること
- アプリケーション内でプロトコル相対URLが使用されていないか監査すること
- セキュリティログを確認し、不審なリクエストがないか調査すること

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-66035)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

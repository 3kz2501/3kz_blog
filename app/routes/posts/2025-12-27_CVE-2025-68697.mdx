---
title: "n8nのCode nodeにおける任意ファイル読み書き脆弱性"
description: "オープンソースワークフロー自動化プラットフォームn8nのセルフホスト版において、Legacy Code nodeを使用している場合、認証済みユーザーが任意のファイル読み書きを実行できる脆弱性が発見されました。CVSSスコアは7.1（HIGH）です。"
date: "2025/12/27"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-68697"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-68697"
tags: ["CVE", "Security", "High"]
---

# 🟠 n8nのCode nodeにおける任意ファイル読み書き脆弱性

## 概要

オープンソースワークフロー自動化プラットフォームn8nのセルフホスト版において、Legacy Code nodeを使用している場合、認証済みユーザーが任意のファイル読み書きを実行できる脆弱性が発見されました。CVSSスコアは7.1（HIGH）です。

**CVE ID**: CVE-2025-68697
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-68697)

## 詳細

## 脆弱性の詳細

n8nは広く使用されているオープンソースのワークフロー自動化プラットフォームです。今回発見された脆弱性は、セルフホスト環境でCode nodeがレガシー（非タスクランナー）JavaScriptモードで動作している場合に発生します。

### 攻撃シナリオ

- ワークフロー編集権限を持つ認証済みユーザーが、Code node内部から内部ヘルパー関数を呼び出すことが可能
- n8nプロセスと同じ権限でn8nホスト上でアクションを実行できる
- インスタンスに設定されたファイルアクセス制限およびOS/コンテナ権限の範囲内で、ホストファイルシステムからのファイル読み取りが可能
- 同様の制限の範囲内で、ホストファイルシステムへのファイル書き込みが可能

### 技術的背景

この脆弱性は、レガシーコードの実行モードにおけるサンドボックス化の不備に起因しています。

## 影響範囲

- 認証済みのワークフロー編集者が、n8nプロセスの権限でホストシステム上の機密ファイルを読み取り可能
- 設定ファイルや環境変数など、重要な情報が漏洩するリスク
- 任意のファイルを書き込むことで、システムの完全性が損なわれる可能性
- 内部システムへの不正アクセスやさらなる攻撃の足がかりとなる恐れ
- セルフホスト環境のみが影響を受け、クラウド版は対象外


### 影響を受ける製品・サービス

- n8n (セルフホスト版) バージョン2.0.0未満


## 対応方法

## 推奨される対応

### 1. バージョンアップデート（推奨）
- **n8n バージョン2.0.0以降にアップデート**することで脆弱性が修正されます

### 2. 回避策（即時対応が必要な場合）

以下の設定により、リスクを軽減できます：

- **ファイル操作の制限**: `N8N_RESTRICT_FILE_ACCESS_TO`を専用ディレクトリ（例：`~/.n8n-files`）に設定し、機密データを含まないようにする
- **設定ファイルへのアクセスブロック**: `N8N_BLOCK_FILE_ACCESS_TO_N8N_FILES=true`（デフォルト）を維持し、`.n8n`およびユーザー定義設定ファイルへのアクセスをブロック
- **高リスクノードの無効化**: ワークフロー編集者が完全に信頼できない場合、`NODES_EXCLUDE`を使用してCode nodeを含む高リスクノードを無効化

### 3. アクセス制御の見直し
- ワークフロー編集権限を持つユーザーを最小限に制限
- 編集権限の付与前に適切な審査を実施

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-68697)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

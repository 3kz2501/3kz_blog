---
title: "Wrangler CLIツールにOSコマンドインジェクションの脆弱性（CVE-2026-0933）"
description: "Cloudflare WranglerのCLIツールにおいて、`wrangler pages deploy`コマンドの`--commit-hash`パラメータに適切な検証が行われず、OSコマンドインジェクション（CWE-78）が可能となる脆弱性が発見されました。CVSSスコアは7.7（HIGH）と評価されています。"
date: "2026/01/21"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2026-0933"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2026-0933"
tags: ["CVE", "Security", "High"]
---

# 🟠 Wrangler CLIツールにOSコマンドインジェクションの脆弱性（CVE-2026-0933）

## 概要

Cloudflare WranglerのCLIツールにおいて、`wrangler pages deploy`コマンドの`--commit-hash`パラメータに適切な検証が行われず、OSコマンドインジェクション（CWE-78）が可能となる脆弱性が発見されました。CVSSスコアは7.7（HIGH）と評価されています。

**CVE ID**: CVE-2026-0933
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2026-0933)

## 詳細

## 脆弱性の詳細

### 根本原因

`--commit-hash` CLIパラメータから取得される `commitHash` 変数が、適切な検証やサニタイゼーション処理を経ずに、テンプレートリテラルを使用してシェルコマンドに直接挿入されています。

具体的には、`execSync(\`git show -s --format=%B ${commitHash}\`)` のような形式でコマンドが実行されるため、シェルのメタ文字が解釈され、任意のコマンド実行が可能となります。

### 攻撃シナリオ

この脆弱性は一般的には悪用が困難ですが、以下のような環境で影響を受ける可能性があります：

- **CI/CDパイプライン**: `wrangler pages deploy`が自動化されたビルドプロセスで使用されている場合
- **外部入力の利用**: `--commit-hash`パラメータが外部の信頼できないソースから取得される場合

### 技術的詳細

- **脆弱性タイプ**: OSコマンドインジェクション（CWE-78）
- **影響を受けるコマンド**: `wrangler pages deploy`
- **脆弱なパラメータ**: `--commit-hash`
- **CVSSスコア**: 7.7（HIGH）

## 影響範囲

攻撃者がこの脆弱性を悪用した場合、以下のような影響が発生する可能性があります：

- **任意のシェルコマンド実行**: システム上で任意のコマンドを実行可能
- **環境変数の窃取**: CI/CD環境内の機密情報（APIキー、認証トークンなど）の漏洩
- **CIランナーの侵害**: バックドアのインストールやビルド成果物の改ざん
- **サプライチェーン攻撃**: 改ざんされたビルド成果物を通じた二次的な攻撃

特にCI/CD環境では、自動化されたデプロイメントプロセスが攻撃対象となるため、影響範囲が広範囲に及ぶ可能性があります。


### 影響を受ける製品・サービス

- Cloudflare Wrangler v4.59.0以前
- Cloudflare Wrangler v3.114.16以前
- Cloudflare Wrangler v2（サポート終了版）


## 対応方法

## 対応方法

### 即時対応（必須）

以下のバージョンへのアップグレードを速やかに実施してください：

- **Wrangler v4ユーザー**: v4.59.1以上にアップグレード
- **Wrangler v3ユーザー**: v3.114.17以上にアップグレード
- **Wrangler v2ユーザー**: サポート終了のため、v3またはv4の最新版への移行を推奨

### 追加の推奨事項

1. **CI/CDパイプラインの見直し**: `--commit-hash`パラメータの入力元を確認し、信頼できるソースのみから取得されていることを確認
2. **最小権限の原則**: CI/CDランナーの実行権限を必要最小限に制限
3. **監視の強化**: 異常なコマンド実行やアクセスパターンを検出できる監視体制の構築

### クレジット

この脆弱性はkny4hackerによって責任を持って報告されました。

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2026-0933)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

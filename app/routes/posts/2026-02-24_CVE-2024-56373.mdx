---
title: "Apache Airflow 2におけるSSTI経由のコード実行脆弱性（CVE-2024-56373）"
description: "Apache Airflow 2において、DAG作成権限を持つユーザーがデータベースを操作することで、Webサーバーコンテキストで任意のコードを実行できる脆弱性が発見されました。ログテンプレート履歴機能を悪用したサーバーサイドテンプレートインジェクション（SSTI）により、リモートコード実行（RCE）が可能になります。"
date: "2026/02/24"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2024-56373"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2024-56373"
tags: ["CVE", "Security", "High"]
---

# 🟠 Apache Airflow 2におけるSSTI経由のコード実行脆弱性（CVE-2024-56373）

## 概要

Apache Airflow 2において、DAG作成権限を持つユーザーがデータベースを操作することで、Webサーバーコンテキストで任意のコードを実行できる脆弱性が発見されました。ログテンプレート履歴機能を悪用したサーバーサイドテンプレートインジェクション（SSTI）により、リモートコード実行（RCE）が可能になります。

**CVE ID**: CVE-2024-56373
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2024-56373)

## 詳細

## 脆弱性の詳細

Apache Airflow 2のログテンプレート履歴機能に、サーバーサイドテンプレートインジェクション（SSTI）の脆弱性が存在します。

### 攻撃シナリオ

- DAG作成者（既に多くの権限を持つユーザー）がAirflowのデータベースを操作
- ログテンプレート履歴情報を悪意あるペイロードで改変
- 他のユーザーが過去のタスク情報を閲覧した際に、Webサーバーコンテキストで任意のコードが実行される
- 本来DAG作成者が持つべきでない権限でのコード実行が可能になる

### 技術的背景

この脆弱性は、ログテンプレート履歴機能がユーザー入力を適切にサニタイズせずにテンプレートエンジンで処理することに起因します。攻撃者は共有データベース内の情報を操作することで、サーバーサイドでのコード実行を実現します。

## 影響範囲

- **リモートコード実行（RCE）**: Webサーバーのコンテキストで任意のコードが実行可能
- **権限昇格**: DAG作成者が本来持たない権限でシステムを操作可能
- **情報漏洩**: サーバー内の機密情報へのアクセスが可能
- **システム侵害**: Webサーバーを起点とした更なる攻撃の踏み台となる可能性
- **トリガー条件**: 他のユーザーが過去のタスク情報を閲覧することで攻撃が発動


### 影響を受ける製品・サービス

- Apache Airflow 2.x（2.11.1未満）


## 対応方法

## 推奨される対応

### 即時対応（必須）

1. **Apache Airflow 2.11.1以降へのアップグレード**
   - バージョン2.11.1では、ログテンプレート履歴機能がデフォルトで無効化されています

2. **Apache Airflow 3への移行（推奨）**
   - ログテンプレート履歴機能を継続して使用したい場合は、修正済みのAirflow 3へアップグレードしてください

### 暫定対応

- **過去のログファイル名の手動修正**
  - 最後のログテンプレート変更前に生成された履歴ログを閲覧する必要がある場合は、手動でファイル名を修正することで対応可能です

### 追加の推奨事項

- DAG作成者の権限を定期的に監査
- データベースアクセスログの監視強化
- 不審なログテンプレート変更の検出

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2024-56373)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

---
title: "LangChain JSにシリアライゼーションインジェクションの脆弱性、シークレット情報の抽出が可能に"
description: "LangChain JSのtoJSON()メソッドにシリアライゼーションインジェクションの脆弱性が発見されました。ユーザー制御可能なデータ内の'lc'キーが適切にエスケープされず、デシリアライゼーション時に正規のLangChainオブジェクトとして扱われることで、シークレット情報の抽出が可能になります。"
date: "2025/12/24"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-68665"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-68665"
tags: ["CVE", "Security", "High"]
---

# 🟠 LangChain JSにシリアライゼーションインジェクションの脆弱性、シークレット情報の抽出が可能に

## 概要

LangChain JSのtoJSON()メソッドにシリアライゼーションインジェクションの脆弱性が発見されました。ユーザー制御可能なデータ内の'lc'キーが適切にエスケープされず、デシリアライゼーション時に正規のLangChainオブジェクトとして扱われることで、シークレット情報の抽出が可能になります。

**CVE ID**: CVE-2025-68665
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-68665)

## 詳細

## 脆弱性の詳細

LangChain JSの`toJSON()`メソッド（および`JSON.stringify()`を使用したオブジェクトの文字列化処理）において、シリアライゼーションインジェクションの脆弱性が存在します。

### 技術的背景

- LangChainは内部的に`lc`キーを使用してシリアライズされたオブジェクトをマーキングしています
- `toJSON()`メソッドは、kwargsの自由形式データをシリアライズする際に、`lc`キーを含むオブジェクトを適切にエスケープしていませんでした
- ユーザー制御可能なデータにこのキー構造が含まれている場合、デシリアライゼーション時に通常のユーザーデータではなく、正規のLangChainオブジェクトとして処理されます

### CVSS評価

- **スコア**: 8.6 (HIGH)
- **深刻度**: 高

## 影響範囲

攻撃者がユーザー入力を通じて特別に細工した'lc'キー構造を注入することで、以下の影響が発生する可能性があります：

- シークレット情報（APIキー、認証トークンなど）の不正な抽出
- LangChainの内部オブジェクト構造の悪用
- アプリケーションのセキュリティ境界の迂回
- LLMを活用したアプリケーションにおける機密データの漏洩


### 影響を受ける製品・サービス

- @langchain/core 0.3.80未満
- @langchain/core 1.1.8未満
- langchain 0.3.37未満
- langchain 1.2.3未満


## 対応方法

## 対応方法

### 即座に実施すべき対策

以下のパッチ適用済みバージョンへのアップデートを強く推奨します：

- **@langchain/core**: バージョン 0.3.80 または 1.1.8 以降
- **langchain**: バージョン 0.3.37 または 1.2.3 以降

### アップデート手順

```bash
# npm の場合
npm update @langchain/core langchain

# yarn の場合
yarn upgrade @langchain/core langchain
```

### 暫定的な回避策

即座にアップデートできない場合は、ユーザー入力に対して'lc'キーを含むデータ構造の検証・サニタイズを実施してください。

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-68665)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

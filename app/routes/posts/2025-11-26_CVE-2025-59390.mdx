---
title: "Apache Druid Kerberos認証における暗号学的に脆弱なシークレット生成の脆弱性"
description: "Apache DruidのKerberos認証機構において、明示的な設定がない場合に暗号学的に安全でない乱数生成器（ThreadLocalRandom）を使用してシークレットが生成される脆弱性が発見されました。この脆弱性により、攻撃者が認証トークンの偽造や認証バイパスを実行できる可能性があります。"
date: "2025/11/26"
page: false
published: true
category: "security"
severity: "high"
cve_id: "CVE-2025-59390"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-59390"
tags: ["CVE", "Security", "High"]
---

# 🟠 Apache Druid Kerberos認証における暗号学的に脆弱なシークレット生成の脆弱性

## 概要

Apache DruidのKerberos認証機構において、明示的な設定がない場合に暗号学的に安全でない乱数生成器（ThreadLocalRandom）を使用してシークレットが生成される脆弱性が発見されました。この脆弱性により、攻撃者が認証トークンの偽造や認証バイパスを実行できる可能性があります。

**CVE ID**: CVE-2025-59390
**深刻度**: HIGH
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-59390)

## 詳細

## 脆弱性の詳細

Apache DruidのKerberos認証機能において、`druid.auth.authenticator.kerberos.cookieSignatureSecret`設定が明示的に指定されていない場合、システムは自動的にフォールバックシークレットを生成します。

### 問題点

1. **脆弱な乱数生成器の使用**: フォールバックシークレットの生成に`ThreadLocalRandom`が使用されています。この乱数生成器は暗号学的に安全ではなく、予測可能な値を生成する可能性があります。

2. **ノード間の不整合**: 各プロセスが独自のフォールバックシークレットを生成するため、分散環境やマルチブローカー構成において、ノード間でシークレットが一致しません。これにより認証エラーが発生し、クラスタの設定ミスを引き起こします。

3. **攻撃の可能性**: 攻撃者がシークレットを予測またはブルートフォース攻撃により特定することで、認証クッキーの署名を偽造し、不正アクセスや認証バイパスが可能になります。

## 影響範囲

- 認証トークンの偽造による不正アクセスの可能性
- 認証メカニズムのバイパス
- 分散環境における認証失敗とサービス障害
- クラスタ全体のセキュリティ侵害のリスク
- Kerberos認証を使用している全てのApache Druid 34.0.0以前のバージョンが影響を受けます


### 影響を受ける製品・サービス

- Apache Druid 34.0.0以前の全バージョン


## 対応方法

## 推奨される対応

### 即時対応（必須）

1. **バージョン35.0.0へのアップグレード**（推奨）
   - Apache Druid 35.0.0にアップグレードしてください
   - このバージョンでは`druid.auth.authenticator.kerberos.cookieSignatureSecret`の設定が必須となり、未設定の場合はサービスが起動しません

2. **明示的なシークレット設定**（暫定対応）
   - アップグレードが即座にできない場合は、暗号学的に安全な方法で生成した強力なシークレットを`druid.auth.authenticator.kerberos.cookieSignatureSecret`に設定してください
   - シークレットは全てのノードで統一する必要があります

### 確認事項

- Kerberos認証を使用しているか確認
- 現在の設定ファイルで`cookieSignatureSecret`が明示的に設定されているか確認
- 分散環境の場合、全ノードで同一のシークレットが使用されているか確認

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-59390)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。

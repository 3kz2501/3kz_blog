---
title: "Langflow 1.6.9以下にCORS設定の不備による認証トークン窃取とリモートコード実行の脆弱性"
description: "Langflow 1.6.9以下のバージョンにおいて、不適切なCORS設定とCookie設定の組み合わせにより、攻撃者がユーザーの認証トークンを窃取し、任意のコードを実行できる脆弱性が発見されました。CVSS深刻度は9.4（Critical）と評価されています。"
date: "2025/12/06"
page: false
published: true
category: "security"
severity: "critical"
cve_id: "CVE-2025-34291"
source: "CVEfeed.io"
original_link: "https://cvefeed.io/vuln/detail/CVE-2025-34291"
tags: ["CVE", "Security", "Critical"]
---

# 🔴 Langflow 1.6.9以下にCORS設定の不備による認証トークン窃取とリモートコード実行の脆弱性

## 概要

Langflow 1.6.9以下のバージョンにおいて、不適切なCORS設定とCookie設定の組み合わせにより、攻撃者がユーザーの認証トークンを窃取し、任意のコードを実行できる脆弱性が発見されました。CVSS深刻度は9.4（Critical）と評価されています。

**CVE ID**: CVE-2025-34291
**深刻度**: CRITICAL
**情報源**: [CVEfeed.io](https://cvefeed.io/vuln/detail/CVE-2025-34291)

## 詳細

## 脆弱性の詳細

Langflow 1.6.9以下のバージョンに、複数の設定不備が連鎖することで発生する重大な脆弱性が存在します。

### 技術的な問題点

1. **過度に緩いCORS設定**
   - `allow_origins='*'`（全てのオリジンを許可）
   - `allow_credentials=True`（認証情報の送信を許可）
   - この組み合わせにより、任意のWebサイトから認証情報を含むクロスオリジンリクエストが可能

2. **不適切なCookie設定**
   - リフレッシュトークンのCookieが`SameSite=None`に設定
   - クロスサイトリクエストでもCookieが送信される状態

3. **連鎖攻撃の流れ**
   - 攻撃者が制御する悪意のあるWebページを被害者が訪問
   - そのページからLangflowのリフレッシュエンドポイントへクロスオリジンリクエストを送信
   - 被害者のリフレッシュトークンが自動的に含まれる
   - 攻撃者が新しいアクセストークンとリフレッシュトークンのペアを取得
   - 取得したトークンで認証済みエンドポイントにアクセス
   - 組み込みのコード実行機能を悪用し、任意のコードを実行

## 影響範囲

- **アカウント乗っ取り**: 被害者のセッショントークンを窃取され、アカウントが完全に乗っ取られる
- **リモートコード実行(RCE)**: 認証後のコード実行機能を悪用し、サーバー上で任意のコードが実行される
- **システム全体の侵害**: 完全なシステム制御が可能となり、データ漏洩、改ざん、サービス停止などの重大な被害が発生する可能性
- **影響範囲**: Langflowを利用する全てのユーザーとシステムが対象


### 影響を受ける製品・サービス

- Langflow 1.6.9以下


## 対応方法

## 推奨される対応策

### 即座に実施すべき対応
1. **バージョンアップ**: Langflowを最新の安全なバージョンにアップデート（1.7.0以降、修正版が公開されている場合）
2. **CORS設定の見直し**:
   - `allow_origins`を特定の信頼できるドメインのみに制限
   - `allow_origins='*'`と`allow_credentials=True`の併用を避ける
3. **Cookie設定の強化**:
   - リフレッシュトークンのCookieを`SameSite=Strict`または`SameSite=Lax`に変更
4. **セッショントークンの無効化**: 既存の全セッションを無効化し、ユーザーに再ログインを要請

### 追加のセキュリティ対策
- ネットワークレベルでのアクセス制限の実装
- セキュリティ監視の強化とログの定期的な確認
- Webアプリケーションファイアウォール(WAF)の導入検討

---

**参考リンク**: [元記事を確認](https://cvefeed.io/vuln/detail/CVE-2025-34291)

この記事は自動生成されました。内容の正確性については保証されませんので、必ず公式情報をご確認ください。
